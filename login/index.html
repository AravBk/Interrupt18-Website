<html>
	<head>
		<title>Interrupt '18 | Login</title>
		<link href="https://fonts.googleapis.com/css?family=Share+Tech+Mono" rel="stylesheet">
		<link href="css/index-css.css" rel="stylesheet">
	</head>

	
	<body>
		
		
		<pre><span id="title">
  _                 _       
 | |               (_)      
 | |     ___   __ _ _ _ __  
 | |    / _ \ / _` | | '_ \ 
 | |___| (_) | (_| | | | | |
 |______\___/ \__, |_|_| |_|
               __/ |        
                                                   |___/                                             
		</span></pre>
		
		
		<form id='register-form' method="post" action="login.php">
			<input type='tel' name='numberInput' class='home-links form-input' id='number-login' placeholder='Mobile Number'>
			<input type='password' name='passInput' class='home-links form-input end' id='pass-login' placeholder='Password'>
			<button type='button' class='home-links submit-butt' id='login-butt'>Login &rarr;</button>
		</form>
						
		<a href="../home.html" class="home-links top">Create Account &rarr;</a>
		<a href="../home.html" class="home-links bottom">Go Back To Home &crarr;</a>
		
	</body>


	<script>
		
		var colorNum=1;
		window.setInterval(colorChange, 1000); //This function calls the colorChange() function every 1 second.

		function colorChange(){
			if(colorNum==1){
				document.getElementById("title").style.color="purple";
				colorNum=2;
			}
			else if(colorNum==2){
				document.getElementById("title").style.color="blue";
				colorNum=3;
			}
			else if(colorNum==3){
				document.getElementById("title").style.color="green";
				colorNum=4;
			}
			else if(colorNum==4){
				document.getElementById("title").style.color="yellow";
				colorNum=5;
			}
			else if(colorNum==5){
				document.getElementById("title").style.color="orange";
				colorNum=6;
			}
			else if(colorNum==6){
				document.getElementById("title").style.color="red";
				colorNum=1;
			}
		} //This function is used to change the color of the interrupt title every time it is called.
		
		function checkMobileNumber(number){ //This function checks if the number is a valid mobile number
			var len=number.length;
			var i=0;
			
			if(len==0){
				return false;
			}

			while(i<len){
				if(number[i]>='0' && number[i]<='9'){
					//We do nothing
				}
				else{
					return false;
				}
				i+=1;
			}

			if(len==10){
				return true;
			}

			return false;	
		}
		
		function authLogin(mobilenum, password){ //This function checks if the number has already been used. Returns true if already there, false if not
			var xmlhttp = new XMLHttpRequest();
	       	xmlhttp.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
					var result=this.responseText;
					if(result=="true"){
						window.location.href="events.html";
					}
					else{
						alert("The mobile and password you seem to have entered do not match. Please try again!");
					}
				}
			};
	        xmlhttp.open("GET", "authLogin.php?number="+mobilenum+"&password="+password, true);
	        xmlhttp.send();
		}
		
		document.getElementById("login-butt").addEventListener("click", function(){ //This has to validate the mobile number and then has to validate the auth details
			var mobile_input=document.getElementById("number-login").value;
			var pass_input=document.getElementById("pass-login").value;
			
			if(checkMobileNumber(mobile_input)==false){
				alert("Oops! You seemed to have entered an invalid mobile number. Please enter a valid number.");
			}
			else{
				authLogin(mobile_input, pass_input);
			}
			
		});
		
	</script>

</html>
